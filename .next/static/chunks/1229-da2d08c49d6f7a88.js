"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1229],{39498:function(e,t,r){r.d(t,{f:function(){return m}});var n=r(77191),a=r(36864),s=r(59499),o=r(4730);r(67294);var c=r(62469),i=r(19160),l=r(82359),d=r(74824),u=r(85893),p=["className","classNames","showOutsideDays"];function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function m(e){var t=e.className,r=e.classNames,s=e.showOutsideDays,f=(0,o.Z)(e,p);return(0,u.jsx)(i._W,h({showOutsideDays:void 0===s||s,className:(0,l.cn)("p-3",t),classNames:h({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,d.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:(0,l.cn)("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md","range"===f.mode?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:(0,l.cn)((0,d.d)({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50  aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible"},r),components:{IconLeft:function(e){return(0,a.Z)({},((0,n.Z)(e),e)),(0,u.jsx)(c.wyc,{className:"h-4 w-4"})},IconRight:function(e){return(0,a.Z)({},((0,n.Z)(e),e)),(0,u.jsx)(c.XCv,{className:"h-4 w-4"})}}},f))}m.displayName="Calendar"},59447:function(e,t,r){r.d(t,{J2:function(){return u},xo:function(){return p},yk:function(){return f}});var n=r(59499),a=r(4730),s=r(67294),o=r(13677),c=r(82359),i=r(85893),l=["className","align","sideOffset"];function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var u=o.fC,p=o.xz;o.ee;var f=s.forwardRef(function(e,t){var r=e.className,s=e.align,u=e.sideOffset,p=(0,a.Z)(e,l);return(0,i.jsx)(o.h_,{children:(0,i.jsx)(o.VY,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({ref:t,align:void 0===s?"center":s,sideOffset:void 0===u?4:u,className:(0,c.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r)},p))})});f.displayName=o.VY.displayName},71229:function(e,t,r){r.r(t);var n=r(59499),a=r(50029),s=r(64687),o=r.n(s),c=r(67294),i=r(45007),l=r(74824),d=r(18190),u=r(25141),p=r(39498),f=r(59447),h=r(14031),m=r(62469),y=r(82359),v=r(34145),g=r(85893);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}t.default=function(e){var t,r,s=e.closeModal,x=(0,c.useState)(void 0),j=x[0],O=x[1],w=(0,c.useState)(""),N=w[0],P=w[1],_=(0,c.useState)(""),k=_[0],S=_[1],E=(0,c.useState)([]),D=E[0],A=E[1],C=(0,c.useState)(""),I=C[0],Z=C[1],z=(0,c.useState)([]),B=z[0],F=z[1],R=(0,c.useState)(null),V=R[0],M=R[1],U=(0,c.useState)(""),G=U[0],W=U[1],J=(0,c.useState)(!1),L=J[0],Q=J[1],T=(0,c.useRef)(null),Y=(0,i.v9)(function(e){return e.auth.token}),X=(0,i.v9)(function(e){return e.auth.role}),q=(0,i.v9)(function(e){return e.auth.employeeId}),H=(0,i.v9)(function(e){return e.auth.employeeId}),K=(0,c.useCallback)((0,a.Z)(o().mark(function e(){var t,r,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="MANAGER"===X?"https://api.gajkesaristeels.in/employee/team/getbyEmployee?id=".concat(q):"https://api.gajkesaristeels.in/employee/getAll",e.next=4,fetch(r,{headers:{Authorization:"Bearer ".concat(Y)}});case 4:return n=e.sent,e.next=7,n.json();case 7:a=e.sent,A("MANAGER"===X?(null===(t=a[0])||void 0===t?void 0:t.fieldOfficers)||[]:Array.isArray(a)?a:[]),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error fetching employees:",e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])})),[X,q,Y]),$=(0,c.useCallback)((t=(0,a.Z)(o().mark(function e(t){var r,n,a,s,c=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:"",e.prev=1,n="https://api.gajkesaristeels.in/store/getByEmployeeWithSort?id=".concat(t,"&storeName=").concat(encodeURIComponent(r),"&sortBy=storeName&sortOrder=asc"),e.next=5,fetch(n,{headers:{Authorization:"Bearer ".concat(Y)}});case 5:return a=e.sent,e.next=8,a.json();case 8:Array.isArray((s=e.sent).content)?F(s.content.map(function(e){return{storeId:e.storeId,storeName:e.storeName}})):console.error("Unexpected response format:",s),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("Error fetching stores:",e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])})),function(e){return t.apply(this,arguments)}),[Y]);(0,c.useEffect)(function(){K()},[K]),(0,c.useEffect)(function(){I&&$(I,G)},[I,G,$]),(0,c.useEffect)(function(){var e=function(e){T.current&&!T.current.contains(e.target)&&Q(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[]);var ee=(r=(0,a.Z)(o().mark(function e(t){var r,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),V){e.next=4;break}return console.error("No store selected"),e.abrupt("return");case 4:return r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({storeId:V.storeId,employeeId:parseInt(I,10),visit_date:j?(0,v.WU)(j,"yyyy-MM-dd"):"",purpose:"Others"===N?k:N,isSelfGenerated:"MANAGER"!==X},"MANAGER"===X&&{assignedById:H}),e.prev=5,e.next=8,fetch("https://api.gajkesaristeels.in/visit/create",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(Y)},body:JSON.stringify(r)});case 8:if(!(a=e.sent).ok){e.next=17;break}return e.next=12,a.json();case 12:console.log("Visit created successfully:",e.sent),s(),e.next=18;break;case 17:console.error("Failed to create visit");case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(5),console.error("Error creating visit:",e.t0);case 23:case"end":return e.stop()}},e,null,[[5,20]])})),function(e){return r.apply(this,arguments)});return(0,g.jsxs)("form",{className:"space-y-6",onSubmit:ee,children:[(0,g.jsxs)("div",{children:[(0,g.jsx)(u._,{htmlFor:"visitDate",children:"Visit Date"}),(0,g.jsxs)(f.J2,{children:[(0,g.jsx)(f.xo,{asChild:!0,children:(0,g.jsxs)(l.z,{variant:"outline",className:(0,y.cn)("w-full justify-start text-left font-normal",!j&&"text-muted-foreground"),children:[(0,g.jsx)(m.Que,{className:"mr-2 h-4 w-4"}),j?(0,v.WU)(j,"PPP"):(0,g.jsx)("span",{children:"Pick a date"})]})}),(0,g.jsx)(f.yk,{className:"w-auto p-0",align:"start",children:(0,g.jsx)(p.f,{mode:"single",selected:j,onSelect:O,initialFocus:!0})})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)(u._,{htmlFor:"visitPurpose",children:"Visit Purpose"}),(0,g.jsxs)(h.Ph,{value:N,onValueChange:P,children:[(0,g.jsx)(h.i4,{children:(0,g.jsx)(h.ki,{placeholder:"Select visit purpose"})}),(0,g.jsx)(h.Bw,{children:["Follow Up","Order","Birthday","Payment","Others"].map(function(e){return(0,g.jsx)(h.Ql,{value:e,children:e},e)})})]})]}),"Others"===N&&(0,g.jsxs)("div",{children:[(0,g.jsx)(u._,{htmlFor:"otherPurpose",children:"Other Purpose"}),(0,g.jsx)(d.I,{id:"otherPurpose",value:k,onChange:function(e){return S(e.target.value)},placeholder:"Specify other purpose"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)(u._,{htmlFor:"employee",children:"Employee"}),(0,g.jsxs)(h.Ph,{value:I,onValueChange:function(e){Z(e),M(null),W(""),$(e)},children:[(0,g.jsx)(h.i4,{children:(0,g.jsx)(h.ki,{placeholder:"Select an employee"})}),(0,g.jsx)(h.Bw,{children:D.map(function(e){return(0,g.jsx)(h.Ql,{value:e.id.toString(),children:"".concat(e.firstName," ").concat(e.lastName)},e.id)})})]})]}),(0,g.jsxs)("div",{ref:T,children:[(0,g.jsx)(u._,{htmlFor:"store",children:"Store"}),(0,g.jsx)(d.I,{type:"text",placeholder:"Search and select store...",value:V?V.storeName:G,onChange:function(e){W(e.target.value),M(null),Q(!0)},onFocus:function(){return Q(!0)},disabled:!I}),L&&B.length>0&&(0,g.jsx)("div",{className:"absolute z-10 w-full bg-white border border-gray-300 mt-1 rounded-md shadow-lg",children:B.slice(0,5).map(function(e){return(0,g.jsx)("div",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:function(){M(e),W(""),Q(!1)},children:e.storeName},e.storeId)})})]}),(0,g.jsx)("div",{className:"flex justify-end",children:(0,g.jsx)(l.z,{type:"submit",children:"Submit Visit"})})]})}}}]);