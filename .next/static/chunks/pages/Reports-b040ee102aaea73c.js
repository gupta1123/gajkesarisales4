(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3230],{74824:function(e,t,r){"use strict";r.d(t,{d:function(){return m},z:function(){return f}});var n=r(59499),a=r(4730),s=r(67294),c=r(88426),o=r(45139),i=r(82359),l=r(85893),u=["className","variant","size","asChild"];function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var m=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),f=s.forwardRef(function(e,t){var r=e.className,s=e.variant,o=e.size,f=e.asChild,p=(0,a.Z)(e,u),x=void 0!==f&&f?c.g7:"button";return(0,l.jsx)(x,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({className:(0,i.cn)(m({variant:s,size:o,className:r})),ref:t},p))});f.displayName="Button"},82422:function(e,t,r){"use strict";r.d(t,{Ol:function(){return y},SZ:function(){return b},Zb:function(){return h},aY:function(){return g},eW:function(){return j},ll:function(){return v}});var n=r(59499),a=r(4730),s=r(67294),c=r(82359),o=r(85893),i=["className"],l=["className"],u=["className"],d=["className"],m=["className"],f=["className"];function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var h=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,i);return(0,o.jsx)("div",x({ref:t,className:(0,c.cn)("rounded-xl border bg-card text-card-foreground shadow",r)},n))});h.displayName="Card";var y=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,l);return(0,o.jsx)("div",x({ref:t,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",r)},n))});y.displayName="CardHeader";var v=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,u);return(0,o.jsx)("h3",x({ref:t,className:(0,c.cn)("font-semibold leading-none tracking-tight",r)},n))});v.displayName="CardTitle";var b=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,d);return(0,o.jsx)("p",x({ref:t,className:(0,c.cn)("text-sm text-muted-foreground",r)},n))});b.displayName="CardDescription";var g=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,m);return(0,o.jsx)("div",x({ref:t,className:(0,c.cn)("p-6 pt-0",r)},n))});g.displayName="CardContent";var j=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,f);return(0,o.jsx)("div",x({ref:t,className:(0,c.cn)("flex items-center p-6 pt-0",r)},n))});j.displayName="CardFooter"},18190:function(e,t,r){"use strict";r.d(t,{I:function(){return u}});var n=r(59499),a=r(4730),s=r(67294),c=r(82359),o=r(85893),i=["className","type"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var u=s.forwardRef(function(e,t){var r=e.className,s=e.type,u=(0,a.Z)(e,i);return(0,o.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({type:s,className:(0,c.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t},u))});u.displayName="Input"},65272:function(e,t,r){"use strict";r.d(t,{O:function(){return l}});var n=r(59499),a=r(4730),s=r(82359),c=r(85893),o=["className"];function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function l(e){var t=e.className,r=(0,a.Z)(e,o);return(0,c.jsx)("div",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({className:(0,s.cn)("animate-pulse rounded-md bg-primary/10",t)},r))}},34642:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return G}});var n=r(67294),a=r(82422),s=r(65440),c=r(16835),o=r(50029),i=r(64687),l=r.n(i),u=r(45007),d=r(23148),m=r(26495),f=r(52403),p=r(74824),x=r(18190),h=r(87066),y=r(43332),v=r(19015),b=r(34145),g=r(35025),j=r(86497);r(2161);var N=r(85893);d.kL.register(d.uw,d.f$,d.od,d.jn,d.Dx,d.u,d.De);var w=function(){var e,t,r=(0,n.useState)([]),s=r[0],i=r[1],d=(0,n.useState)([]),w=d[0],O=d[1],k=(0,n.useState)([]),S=k[0],C=k[1],P=(0,n.useState)({}),D=P[0],M=P[1],Z=(0,n.useState)("2024-05-18"),z=Z[0],A=Z[1],E=(0,n.useState)("2024-07-18"),I=E[0],Y=E[1],L=(0,n.useState)(!0),R=L[0],F=L[1],V=(0,n.useState)(!0),T=V[0],q=V[1],B=(0,u.v9)(function(e){return e.auth.token});(0,n.useEffect)(function(){B&&W()},[B]),(0,n.useEffect)(function(){B&&z&&I&&_()},[B,z,I]);var W=(e=(0,o.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.Z.get("https://api.gajkesaristeels.in/employee/getAll",{headers:{Authorization:"Bearer ".concat(B)}});case 3:i(e.sent.data.filter(function(e){return"Field Officer"===e.role}).map(function(e){return{value:e.id,label:"".concat(e.firstName," ").concat(e.lastName)}}).sort(function(e,t){return e.label.localeCompare(t.label)})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching employees:",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])})),function(){return e.apply(this,arguments)}),_=(t=(0,o.Z)(l().mark(function e(){var t,r,n;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,y.Qc)(z,"yyyy-MM-dd",new Date),r=(0,y.Qc)(I,"yyyy-MM-dd",new Date),n=(0,v.R)({start:t,end:r}).map(function(){var e=(0,o.Z)(l().mark(function e(t){var r,n,a;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,b.WU)((0,g.N)(t),"yyyy-MM-dd"),n=(0,b.WU)((0,j.V)(t),"yyyy-MM-dd"),e.prev=2,e.next=5,h.Z.get("https://api.gajkesaristeels.in/report/getForEmployee",{params:{startDate:r,endDate:n},headers:{Authorization:"Bearer ".concat(B)}});case 5:return a=e.sent,e.abrupt("return",{month:(0,b.WU)(t,"MMMM yyyy"),data:a.data});case 9:return e.prev=9,e.t0=e.catch(2),console.error("Error fetching report data for ".concat((0,b.WU)(t,"MMMM yyyy"),":"),e.t0),e.abrupt("return",{month:(0,b.WU)(t,"MMMM yyyy"),data:[]});case 13:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}()),e.next=6,Promise.all(n);case 6:M(Object.fromEntries(e.sent.map(function(e){return[e.month,e.data]})));case 9:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),U=(0,n.useMemo)(function(){var e=S.map(function(e){return e.label});return Object.fromEntries(Object.entries(D).map(function(t){var r=(0,c.Z)(t,2);return[r[0],r[1].filter(function(t){return!e.includes(t.employeeName)})]}))},[D,S]),H=(0,n.useMemo)(function(){var e=Object.entries(Object.values(U).flat().reduce(function(e,t){return e[t.employeeName]||(e[t.employeeName]=0),e[t.employeeName]+=t.newStoreCount,e},{})).sort(function(e,t){var r=(0,c.Z)(e,2)[1];return(0,c.Z)(t,2)[1]-r}).map(function(e){var t=(0,c.Z)(e,2);return{name:t[0],count:t[1]}});return{topPerformers:e.slice(0,5),bottomPerformers:e.slice(-5).reverse(),allPerformers:e}},[U]),$=(0,n.useCallback)(function(){if(T){for(var e=(R?H.topPerformers:H.bottomPerformers).map(function(e){return s.find(function(t){return t.label.includes(e.name)})}).filter(function(e){return void 0!==e}),t=s.filter(function(e){return!S.some(function(t){return t.value===e.value})}).sort(function(e,t){var r,n,a=(null===(r=H.topPerformers.find(function(t){return t.name.includes(e.label)}))||void 0===r?void 0:r.count)||0,s=(null===(n=H.topPerformers.find(function(e){return e.name.includes(t.label)}))||void 0===n?void 0:n.count)||0;return R?s-a:a-s});e.length<5&&e.length<t.length;){var r=t.find(function(t){return!e.some(function(e){return e.value===t.value})});if(r)e.push(r);else break}O(e)}},[s,S,H,R,T]);(0,n.useEffect)(function(){$()},[$]);var K=(0,n.useMemo)(function(){var e=Object.keys(U),t=w.map(function(t){return{label:t.label,data:e.map(function(e){var r=U[e].find(function(e){return e.employeeName===t.label});return r?r.newStoreCount:0}),borderColor:"hsl(".concat(360*Math.random(),", 70%, 50%)"),tension:.1}});return{labels:e,datasets:t}},[U,w]),Q=(0,n.useCallback)(function(e){return Object.values(U).reduce(function(t,r){var n=r.find(function(t){return t.employeeName===e});return t+(n?n.newStoreCount:0)},0)},[U]);return(0,N.jsxs)("div",{className:"container-newCustomersReport mx-auto px-4 py-6 space-y-6",children:[(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsxs)(a.aY,{className:"p-4 space-y-4",children:[(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Date Range"}),(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[(0,N.jsx)(x.I,{type:"date",value:z,onChange:function(e){return A(e.target.value)},className:"w-full"}),(0,N.jsx)(x.I,{type:"date",value:I,onChange:function(e){return Y(e.target.value)},className:"w-full"})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Select Employees"}),(0,N.jsx)(f.ZP,{isMulti:!0,name:"employees",options:s.filter(function(e){return!S.some(function(t){return t.value===e.value})}),className:"basic-multi-select",classNamePrefix:"select",onChange:function(e,t){O(e),q(!1)},value:w})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Exclude Employees"}),(0,N.jsx)(f.ZP,{isMulti:!0,name:"excludedEmployees",options:s,className:"basic-multi-select",classNamePrefix:"select",onChange:function(e,t){C(e),T?$():O(function(t){return t.filter(function(t){return!e.some(function(e){return e.value===t.value})})})},value:S})]})]}),(0,N.jsxs)("div",{className:"flex flex-wrap justify-center sm:justify-end space-x-2 space-y-2 sm:space-y-0",children:[(0,N.jsx)(p.z,{onClick:function(){F(!0),q(!0)},size:"sm",variant:R&&T?"default":"outline",children:"Top 5 Performers"}),(0,N.jsx)(p.z,{onClick:function(){F(!1),q(!0)},size:"sm",variant:!R&&T?"default":"outline",children:"Bottom 5 Performers"}),(0,N.jsx)(p.z,{onClick:_,size:"sm",children:"Refresh Data"})]})]})}),(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsx)(a.aY,{className:"p-4",children:(0,N.jsx)("div",{style:{height:"300px"},children:(0,N.jsx)(m.x1,{data:K,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{boxWidth:10,font:{size:10}}},title:{display:!0,text:"New Customers Acquired",font:{size:16}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Number of New Customers",font:{size:12}},ticks:{font:{size:10}}},x:{ticks:{font:{size:10}}}}}})})})}),(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsxs)(a.aY,{className:"p-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Selected Employees Performance"}),(0,N.jsx)("ul",{className:"space-y-2",children:w.map(function(e,t){var r=Q(e.label);return(0,N.jsxs)("li",{className:"flex justify-between items-center",children:[(0,N.jsx)("span",{className:"text-sm",children:e.label}),(0,N.jsxs)("span",{className:"font-medium",children:[r," new customers"]})]},t)})})]})})]})};r(86961);var O=r(30381),k=r.n(O);r(63603),d.kL.register(d.uw,d.f$,d.ZL,d.jn,d.od,d.Dx,d.u,d.De,d.FB,d.vn,d.ST);var S=function(){var e,t=(0,n.useState)([]),r=t[0],s=t[1],c=(0,n.useState)(null),i=c[0],d=c[1],y=(0,n.useState)([]),v=y[0],b=y[1],g=(0,n.useState)(!1),j=g[0],w=g[1],O=(0,n.useState)(null),S=O[0],C=O[1],P=(0,n.useState)(k()().subtract(3,"months").format("YYYY-MM-DD")),D=P[0],M=P[1],Z=(0,n.useState)(k()().format("YYYY-MM-DD")),z=Z[0],A=Z[1],E=(0,n.useState)(""),I=E[0],Y=E[1],L=(0,n.useState)(""),R=L[0],F=L[1],V=(0,n.useState)(0),T=V[0],q=V[1],B=(0,n.useState)(0),W=B[0],_=B[1],U=(0,u.v9)(function(e){return e.auth.token}),H=(0,n.useCallback)((0,o.Z)(l().mark(function e(){var t;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.Z.get("https://api.gajkesaristeels.in/store/filteredValues",{params:{storeName:I,city:R,page:T,size:10,sort:"storeName,asc"},headers:{Authorization:"Bearer ".concat(U)}});case 3:(t=e.sent).data&&t.data.content?(s(t.data.content.map(function(e){return{value:e.storeId,label:e.storeName,city:e.city}})),_(t.data.totalPages)):C("Unexpected API response structure"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching stores:",e.t0),C("Failed to fetch stores");case 11:case"end":return e.stop()}},e,null,[[0,7]])})),[U,I,R,T]);(0,n.useEffect)(function(){U&&H()},[H,U]);var $=(0,n.useCallback)((e=(0,o.Z)(l().mark(function e(t,r,n){var a;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.Z.get("https://api.gajkesaristeels.in/report/getAvgValues",{params:{startDate:t,endDate:r,storeId:n},headers:{Authorization:"Bearer ".concat(U)}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:throw e.prev=7,e.t0=e.catch(0),console.error("Error fetching data for ".concat(t," to ").concat(r,":"),e.t0),e.t0;case 11:case"end":return e.stop()}},e,null,[[0,7]])})),function(t,r,n){return e.apply(this,arguments)}),[U]),K=(0,n.useCallback)((0,o.Z)(l().mark(function e(){var t,r,n,a,s,c,o,u;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=3;break}return C("Please select a store"),e.abrupt("return");case 3:w(!0),C(null),e.prev=5,t=[],r=k()(D).startOf("month"),n=k()(z);case 9:if(!r.isSameOrBefore(n)){e.next=21;break}return a=r.format("YYYY-MM-DD"),s=k().min(r.clone().endOf("month"),n).format("YYYY-MM-DD"),e.next=14,$(a,s,i.value);case 14:o=(c=e.sent).monthlySaleLogs.length>0?c.monthlySaleLogs.reduce(function(e,t){return e+t.newMonthlySale},0)/c.monthlySaleLogs.length:0,u=c.intentLogs.length>0?c.intentLogs.reduce(function(e,t){return e+t.newIntentLevel},0)/c.intentLogs.length:0,t.push({month:r.format("YYYY-MM"),avgMonthlySale:o,avgIntent:u,totalVisitCount:c.totalVisitCount}),r.add(1,"month"),e.next=9;break;case 21:b(t),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(5),C("Failed to fetch report data"),console.error(e.t0);case 28:return e.prev=28,w(!1),e.finish(28);case 31:case"end":return e.stop()}},e,null,[[5,24,28,31]])})),[i,D,z,$]),Q={labels:v.map(function(e){return e.month}),datasets:[{type:"line",label:"Average Monthly Sales",data:v.map(function(e){return Math.round(e.avgMonthlySale)}),borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.5)",borderWidth:2,fill:!1,yAxisID:"y"},{type:"bar",label:"Average Intent Level",data:v.map(function(e){return Math.round(e.avgIntent)}),backgroundColor:"rgba(255, 159, 64, 0.5)",borderColor:"rgba(255, 159, 64, 1)",borderWidth:1,yAxisID:"y1"},{type:"bar",label:"Total Visit Count",data:v.map(function(e){return e.totalVisitCount}),backgroundColor:"rgba(153, 102, 255, 0.5)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1,yAxisID:"y2"}]},X=function(e){var t=e.target,r=t.name,n=t.value;"startDate"===r&&M(n),"endDate"===r&&A(n)},G=function(e){var t=e.target,r=t.name,n=t.value;"storeName"===r&&Y(n),"city"===r&&F(n),q(0)},J=function(e){q(e)};return(0,N.jsxs)("div",{className:"container-salesPerformanceReport space-y-4 p-4 md:space-y-6 md:p-6",children:[(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsxs)(a.aY,{className:"p-4 md:p-6",children:[(0,N.jsx)("h2",{className:"text-xl md:text-2xl font-bold mb-4 md:mb-6",children:"Sales Performance Report"}),(0,N.jsxs)("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-3 md:gap-4",children:[(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsx)("label",{className:"block text-sm font-medium",children:"Store Filter"}),(0,N.jsx)(x.I,{placeholder:"Store Name",name:"storeName",value:I,onChange:G,className:"w-full"}),(0,N.jsx)(x.I,{placeholder:"City",name:"city",value:R,onChange:G,className:"w-full"})]}),(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsx)("label",{className:"block text-sm font-medium",children:"Store Selection"}),(0,N.jsx)(f.ZP,{options:r,value:i,onChange:function(e){d(e)},className:"basic-single",classNamePrefix:"select",placeholder:"Select Store"}),(0,N.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,N.jsx)(p.z,{onClick:function(){return J(T-1)},disabled:0===T,size:"sm",children:"Previous"}),(0,N.jsxs)("span",{className:"text-sm",children:["Page ",T+1," of ",W]}),(0,N.jsx)(p.z,{onClick:function(){return J(T+1)},disabled:T===W-1,size:"sm",children:"Next"})]})]}),(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsx)("label",{className:"block text-sm font-medium",children:"Date Range"}),(0,N.jsx)(x.I,{type:"date",name:"startDate",value:D,onChange:X,className:"w-full"}),(0,N.jsx)(x.I,{type:"date",name:"endDate",value:z,onChange:X,className:"w-full"})]})]}),(0,N.jsxs)("div",{className:"flex flex-col md:flex-row justify-end space-y-2 md:space-y-0 md:space-x-2 mt-4",children:[(0,N.jsx)(p.z,{onClick:H,className:"w-full md:w-auto",children:"Apply Filters"}),(0,N.jsx)(p.z,{onClick:K,disabled:j||!i,className:"w-full md:w-auto",children:"Generate Report"})]})]})}),j&&(0,N.jsx)("p",{className:"text-center py-4",children:"Loading..."}),S&&(0,N.jsx)("p",{className:"text-red-500 text-center py-4",children:S}),v.length>0&&(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsxs)(a.aY,{className:"p-4 md:p-6",children:[(0,N.jsxs)("h2",{className:"text-lg md:text-xl font-bold mb-4",children:["Monthly Report for ",null==i?void 0:i.label]}),(0,N.jsx)("div",{className:"h-[300px] md:h-[500px]",children:(0,N.jsx)(m.kL,{type:"bar",data:Q,options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"month",displayFormats:{month:"MMM YYYY"}},title:{display:!0,text:"Month",font:{size:12}},ticks:{font:{size:10}}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Average Monthly Sales",font:{size:12}},ticks:{callback:function(e){return Math.round(Number(e))},font:{size:10}}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Average Intent Level",font:{size:12}},grid:{drawOnChartArea:!1},ticks:{callback:function(e){return Math.round(Number(e))},font:{size:10}}},y2:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Total Visit Count",font:{size:12}},grid:{drawOnChartArea:!1},ticks:{font:{size:10}}}},plugins:{tooltip:{callbacks:{title:function(e){return k()(e[0].parsed.x).format("MMMM YYYY")}}},legend:{position:"top",labels:{font:{size:10},boxWidth:10,padding:10}}}}})})]})})]})},C=r(27812);r(28735),d.kL.register(d.uw,d.f$,d.ZL,d.jn,d.od,d.Dx,d.u,d.De,d.vn,d.ST);var P=function(){var e,t,r=(0,n.useState)([]),s=r[0],c=r[1],i=(0,n.useState)(null),d=i[0],y=i[1],v=(0,n.useState)([]),b=v[0],g=v[1],j=(0,n.useState)("mostVisited"),w=j[0],O=j[1],k=(0,n.useState)("2024-05-01"),S=k[0],P=k[1],D=(0,n.useState)("2024-06-30"),M=D[0],Z=D[1],z=(0,u.v9)(function(e){return e.auth.token});(0,n.useEffect)(function(){z&&A()},[z]),(0,n.useEffect)(function(){d&&E()},[d,S,M]);var A=(e=(0,o.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.Z.get("https://api.gajkesaristeels.in/employee/getAll",{headers:{Authorization:"Bearer ".concat(z)}});case 3:c(e.sent.data.filter(function(e){return"Field Officer"===e.role}).map(function(e){return{value:e.id,label:"".concat(e.firstName," ").concat(e.lastName)}}).sort(function(e,t){return e.label.localeCompare(t.label)})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching employees:",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])})),function(){return e.apply(this,arguments)}),E=(t=(0,o.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,h.Z.get("https://api.gajkesaristeels.in/report/getStoreStats",{params:{employeeId:d.value,startDate:S,endDate:M},headers:{Authorization:"Bearer ".concat(z)}});case 5:g(e.sent.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error("Error fetching store stats:",e.t0);case 12:case"end":return e.stop()}},e,null,[[2,9]])})),function(){return t.apply(this,arguments)}),I=function(e){var t=e.target,r=t.name,n=t.value;"startDate"===r?P(n):"endDate"===r&&Z(n)},Y=function(e){return e.intentLogs&&e.intentLogs.length>0?e.intentLogs.reduce(function(e,t){return e+t.newIntentLevel},0)/e.intentLogs.length:e.intentLevel||0},L=function(e){return e.monthlySaleLogs&&e.monthlySaleLogs.length>0?e.monthlySaleLogs.reduce(function(e,t){return e+t.newMonthlySale},0)/e.monthlySaleLogs.length:e.monthlySales||0},R=(0,n.useMemo)(function(){var e=(0,C.Z)(b);switch(w){case"mostVisited":return e.sort(function(e,t){return(t.visitFrequency||0)-(e.visitFrequency||0)}).slice(0,10);case"leastVisited":return e.sort(function(e,t){return(e.visitFrequency||0)-(t.visitFrequency||0)}).slice(0,10);case"highestIntent":return e.sort(function(e,t){return Y(t)-Y(e)}).slice(0,10);case"lowestIntent":return e.sort(function(e,t){return Y(e)-Y(t)}).slice(0,10);case"highestSales":return e.sort(function(e,t){return L(t)-L(e)}).slice(0,10);case"lowestSales":return e.sort(function(e,t){return L(e)-L(t)}).slice(0,10)}},[b,w]),F=(0,n.useMemo)(function(){return{labels:R.map(function(e){return e.storeName||"Store ".concat(e.storeId)}),datasets:[{type:"bar",label:"Visit Frequency",data:R.map(function(e){return e.visitFrequency||0}),backgroundColor:"rgba(255, 99, 132, 0.5)",yAxisID:"y"},{type:"bar",label:"Average Intent Level",data:R.map(function(e){return Y(e)}),backgroundColor:"rgba(53, 162, 235, 0.5)",yAxisID:"y"},{type:"line",label:"Average Monthly Sales",data:R.map(function(e){return L(e)}),borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.5)",yAxisID:"y1"}]}},[R]);return(0,N.jsxs)("div",{className:"container-visitfrequency space-y-4 p-4",children:[(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsxs)(a.aY,{className:"p-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select Employee"}),(0,N.jsx)(f.ZP,{options:s,value:d,onChange:function(e){y(e)},className:"basic-single",classNamePrefix:"select"})]})}),(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsxs)(a.aY,{className:"p-4",children:[(0,N.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select Date Range"}),(0,N.jsxs)("div",{className:"flex flex-col space-y-2 sm:flex-row sm:space-y-0 sm:space-x-4",children:[(0,N.jsx)(x.I,{type:"date",name:"startDate",value:S,onChange:I,className:"w-full sm:w-1/2"}),(0,N.jsx)(x.I,{type:"date",name:"endDate",value:M,onChange:I,className:"w-full sm:w-1/2"})]})]})}),d&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[(0,N.jsx)(p.z,{onClick:function(){return O("mostVisited")},className:"text-xs sm:text-sm",children:"Most Visited"}),(0,N.jsx)(p.z,{onClick:function(){return O("leastVisited")},className:"text-xs sm:text-sm",children:"Least Visited"}),(0,N.jsx)(p.z,{onClick:function(){return O("highestIntent")},className:"text-xs sm:text-sm",children:"Highest Intent"}),(0,N.jsx)(p.z,{onClick:function(){return O("lowestIntent")},className:"text-xs sm:text-sm",children:"Lowest Intent"}),(0,N.jsx)(p.z,{onClick:function(){return O("highestSales")},className:"text-xs sm:text-sm",children:"Highest Sales"}),(0,N.jsx)(p.z,{onClick:function(){return O("lowestSales")},className:"text-xs sm:text-sm",children:"Lowest Sales"})]}),(0,N.jsx)(a.Zb,{className:"shadow-md",children:(0,N.jsx)(a.aY,{className:"p-4",children:(0,N.jsx)("div",{className:"h-[300px] sm:h-[400px]",children:(0,N.jsx)(m.kL,{type:"bar",options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{boxWidth:10,font:{size:10}}},title:{display:!0,text:"Store Statistics",font:{size:14}}},scales:{x:{stacked:!1,ticks:{font:{size:8}}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Visit Frequency / Intent Level",font:{size:10}},ticks:{font:{size:8}}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Average Monthly Sales",font:{size:10}},grid:{drawOnChartArea:!1},ticks:{font:{size:8}}}}},data:F})})})})]})]})},D=r(65272),M=r(59499),Z=r(4730),z=r(45139),A=r(82359),E=["className","variant"],I=["className"],Y=["className"];function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach(function(t){(0,M.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var F=(0,z.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),V=n.forwardRef(function(e,t){var r=e.className,n=e.variant,a=(0,Z.Z)(e,E);return(0,N.jsx)("div",R({ref:t,role:"alert",className:(0,A.cn)(F({variant:n}),r)},a))});V.displayName="Alert",n.forwardRef(function(e,t){var r=e.className,n=(0,Z.Z)(e,I);return(0,N.jsx)("h5",R({ref:t,className:(0,A.cn)("mb-1 font-medium leading-none tracking-tight",r)},n))}).displayName="AlertTitle";var T=n.forwardRef(function(e,t){var r=e.className,n=(0,Z.Z)(e,Y);return(0,N.jsx)("div",R({ref:t,className:(0,A.cn)("text-sm [&_p]:leading-relaxed",r)},n))});T.displayName="AlertDescription";var q=r(30714),B=r(22692),W=r(21049),_=r(14036),U=r(32751),H=r(25737),$=r(63157);r(60172);var K=["#8884d8","#82ca9d","#ffc658","#ff7300","#0088FE","#00C49F","#FFBB28","#FF8042"],Q=Math.PI/180,X=function(){var e,t,r=(0,n.useState)([]),s=r[0],i=r[1],d=(0,n.useState)(null),m=d[0],p=d[1],y=(0,n.useState)([]),v=y[0],b=y[1],g=(0,n.useState)(null),j=g[0],w=g[1],O=(0,n.useState)("2024-05-01"),k=O[0],S=O[1],C=(0,n.useState)("2024-06-25"),P=C[0],M=C[1],Z=(0,n.useState)(!1),z=Z[0],A=Z[1],E=(0,n.useState)(0),I=E[0],Y=E[1],L=(0,u.v9)(function(e){return e.auth.token});(0,n.useEffect)(function(){L&&R()},[L]),(0,n.useEffect)(function(){m&&F()},[m,k,P]);var R=(e=(0,o.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.Z.get("https://api.gajkesaristeels.in/employee/getAll",{headers:{Authorization:"Bearer ".concat(L)}});case 3:i(e.sent.data.filter(function(e){return"Field Officer"===e.role}).map(function(e){return{value:e.id,label:"".concat(e.firstName," ").concat(e.lastName)}}).sort(function(e,t){return e.label.localeCompare(t.label)})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching employees:",e.t0),w("Failed to fetch employees");case 13:case"end":return e.stop()}},e,null,[[0,9]])})),function(){return e.apply(this,arguments)}),F=(t=(0,o.Z)(l().mark(function e(){var t,r;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m){e.next=2;break}return e.abrupt("return");case 2:return A(!0),w(null),e.prev=4,e.next=7,h.Z.get("https://api.gajkesaristeels.in/report/getByStoreType",{params:{employeeId:m.value,startDate:k,endDate:P},headers:{Authorization:"Bearer ".concat(L)}});case 7:r=Object.values((t=e.sent).data).reduce(function(e,t){return e+t},0),b(Object.entries(t.data).map(function(e){var t=(0,c.Z)(e,2);return{name:t[0],value:t[1]/r*100}})),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(4),console.error("Error fetching customer type data:",e.t0),w("Failed to fetch customer type data"),b([]);case 18:return e.prev=18,A(!1),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[4,13,18,21]])})),function(){return t.apply(this,arguments)}),X=function(e){var t=e.target,r=t.name,n=t.value;"startDate"===r?S(n):"endDate"===r&&M(n)},G=(0,n.useCallback)(function(e){var t=e.cx,r=e.cy,n=e.midAngle,a=e.innerRadius,s=e.outerRadius,c=e.startAngle,o=e.endAngle,i=e.fill,l=e.payload,u=e.percent,d=Math.sin(-Q*n),m=Math.cos(-Q*n),f=t+(s+10)*m,p=r+(s+10)*d,x=t+(s+30)*m,h=r+(s+30)*d,y=x+(m>=0?1:-1)*22,v=m>=0?"start":"end";return(0,N.jsxs)("g",{children:[(0,N.jsx)("text",{x:t,y:r,dy:8,textAnchor:"middle",fill:i,className:"text-xs md:text-sm",children:l.name}),(0,N.jsx)(q.L,{cx:t,cy:r,innerRadius:a,outerRadius:s,startAngle:c,endAngle:o,fill:i}),(0,N.jsx)(q.L,{cx:t,cy:r,startAngle:c,endAngle:o,innerRadius:s+6,outerRadius:s+10,fill:i}),(0,N.jsx)("path",{d:"M".concat(f,",").concat(p,"L").concat(x,",").concat(h,"L").concat(y,",").concat(h),stroke:i,fill:"none"}),(0,N.jsx)("circle",{cx:y,cy:h,r:2,fill:i,stroke:"none"}),(0,N.jsx)("text",{x:y+(m>=0?1:-1)*12,y:h,textAnchor:v,fill:"#333",className:"text-xs md:text-sm",children:"".concat(l.name)}),(0,N.jsx)("text",{x:y+(m>=0?1:-1)*12,y:h,dy:18,textAnchor:v,fill:"#999",className:"text-xs md:text-sm",children:"".concat((100*u).toFixed(2),"%")})]})},[]),J=(0,n.useCallback)(function(e,t){Y(t)},[]),ee=(0,n.useCallback)(function(e){var t=e.payload;return(0,N.jsx)("ul",{className:"list-none pl-0 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 text-xs",children:(void 0===t?[]:t).map(function(e,t){return(0,N.jsxs)("li",{className:"flex items-center",children:[(0,N.jsx)("div",{className:"w-3 h-3 mr-2",style:{backgroundColor:e.color}}),(0,N.jsxs)("span",{children:[e.value,": ",e.payload.value.toFixed(1),"%"]})]},"item-".concat(t))})})},[]);return(0,N.jsxs)("div",{className:"container-customerType space-y-4 max-w-4xl mx-auto p-4",children:[(0,N.jsxs)(a.Zb,{className:"shadow-md",children:[(0,N.jsx)(a.Ol,{children:(0,N.jsx)(a.ll,{className:"text-xl md:text-2xl",children:"Customer Type Analysis Report"})}),(0,N.jsxs)(a.aY,{className:"space-y-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-base md:text-lg font-semibold mb-2",children:"Select Employee"}),(0,N.jsx)(f.ZP,{options:s,value:m,onChange:function(e){p(e)},className:"basic-single",classNamePrefix:"select",placeholder:"Select an employee..."})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"text-base md:text-lg font-semibold mb-2",children:"Select Date Range"}),(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[(0,N.jsx)(x.I,{type:"date",name:"startDate",value:k,onChange:X,className:"w-full sm:w-1/2"}),(0,N.jsx)(x.I,{type:"date",name:"endDate",value:P,onChange:X,className:"w-full sm:w-1/2"})]})]})]})]}),j&&(0,N.jsx)(V,{variant:"destructive",children:(0,N.jsx)(T,{children:j})}),(0,N.jsxs)(a.Zb,{className:"shadow-md",children:[(0,N.jsx)(a.Ol,{children:(0,N.jsx)(a.ll,{className:"text-lg md:text-xl",children:"Client Type Distribution"})}),(0,N.jsx)(a.aY,{className:"overflow-x-auto",children:z?(0,N.jsx)("div",{className:"w-full h-[300px] md:h-[500px] flex items-center justify-center",children:(0,N.jsx)(D.O,{className:"w-[200px] h-[200px] md:w-[400px] md:h-[400px] rounded-full"})}):0===v.length?(0,N.jsx)("p",{className:"text-center text-gray-500",children:"No data available"}):(0,N.jsx)("div",{className:"w-full h-[300px] md:h-[500px]",children:(0,N.jsx)(B.h,{children:(0,N.jsxs)(W.u,{children:[(0,N.jsx)(_.b,{activeIndex:I,activeShape:G,data:v,cx:"50%",cy:"50%",innerRadius:"30%",outerRadius:"60%",fill:"#8884d8",dataKey:"value",onMouseEnter:J,label:!1,children:v.map(function(e,t){return(0,N.jsx)(U.b,{fill:K[t%K.length]},"cell-".concat(t))})}),(0,N.jsx)(H.u,{formatter:function(e){return"".concat(e.toFixed(1),"%")}}),(0,N.jsx)($.D,{content:(0,N.jsx)(ee,{}),verticalAlign:"bottom",height:36})]})})})})]})]})};r(44607);var G=function(){var e=(0,n.useState)("newCustomers"),t=e[0],r=e[1],c=[{id:"newCustomers",label:"New Customers Acquired",icon:s.WY8,description:"View statistics on new customers acquired by employees"},{id:"salesPerformance",label:"Sales Performance",icon:s.orK,description:"Analyze sales performance across different products and regions"},{id:"visitFrequency",label:"Visit Frequency",icon:s.MIl,description:"Analyze visit frequency, intent level, and monthly sales by employee"},{id:"customerTypeAnalysis",label:"Customer Type Analysis",icon:s.CFv,description:"Analyze customer types for each employee"}];return(0,N.jsxs)("div",{className:"container-reports mx-auto px-4 py-8",children:[(0,N.jsx)("div",{children:(0,N.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Reports"})}),(0,N.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:c.map(function(e){return(0,N.jsx)(a.Zb,{className:"cursor-pointer hover:shadow-lg transition-shadow duration-300 ".concat(t===e.id?"ring-2 ring-blue-500":""),onClick:function(){return r(e.id)},children:(0,N.jsxs)(a.aY,{className:"p-4 flex flex-col items-center text-center",children:[(0,N.jsx)(e.icon,{className:"w-8 h-8 mb-2"}),(0,N.jsx)("h3",{className:"font-semibold mb-1",children:e.label}),(0,N.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]})},e.id)})}),"newCustomers"===t&&(0,N.jsx)(w,{}),"salesPerformance"===t&&(0,N.jsx)(S,{}),"visitFrequency"===t&&(0,N.jsx)(P,{}),"customerTypeAnalysis"===t&&(0,N.jsx)(X,{})]})}},40731:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Reports",function(){return r(34642)}])},60172:function(){},2161:function(){},63603:function(){},28735:function(){},44607:function(){}},function(e){e.O(0,[2196,4885,9545,4145,2403,9676,870,3308,2888,9774,179],function(){return e(e.s=40731)}),_N_E=e.O()}]);