(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2781],{8601:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ea}});var n,a,r,i=s(16835),c=s(27812),o=s(50029),l=s(64687),u=s.n(l),d=s(67294),m=s(87066),p=s(45007),h=s(88767),x=s(11163),f=s(74824),N=s(97945),v=s(34145),j=s(23245),y=s(6425),g=s(92215),b=s(8593),k=s(80300),w=s(75101),C=s(54386),D=s(56959),S=s(46547),E=s(21659),M=s(375),A=s(13114),P=s(85893),I=function(e){return e?(0,v.WU)(new Date(e),"d MMM ''yy"):""},Z=function(e,t){if(e&&t){var s=t.split(":"),n=(0,i.Z)(s,2),a=n[0],r=n[1];return(0,v.WU)(new Date("".concat(e,"T").concat(a,":").concat(r)),"h:mm a")}return""},_=function(e){var t=e.visits,s=e.selectedColumns,n=e.sortColumn,a=e.sortDirection,r=(e.itemsPerPage,e.currentPage,e.onSort);e.onBulkAction;var c=(0,x.useRouter)(),o=d.useState(null),l=(0,i.Z)(o,2),u=l[0],m=l[1],p=function(e){c.push("/VisitDetailPage/".concat(e))},h=function(e){return e.checkinDate&&e.checkinTime&&e.checkoutDate&&e.checkoutTime?{icon:(0,P.jsx)(j.Z,{className:"w-4 h-4"}),status:"Completed",color:"bg-green-100 text-green-800"}:e.checkoutDate&&e.checkoutTime?{icon:(0,P.jsx)(y.Z,{className:"w-4 h-4"}),status:"Checked Out",color:"bg-orange-100 text-orange-800"}:e.checkinDate&&e.checkinTime?{icon:(0,P.jsx)(g.Z,{className:"w-4 h-4 animate-spin"}),status:"On Going",color:"bg-blue-100 text-blue-800"}:{icon:(0,P.jsx)(b.Z,{className:"w-4 h-4"}),status:"Assigned",color:"bg-purple-100 text-purple-800"}};return(0,P.jsxs)("div",{className:"p-2 sm:p-4 lg:p-6",children:[(0,P.jsx)("div",{className:"hidden md:block",children:(0,P.jsxs)("table",{className:"w-full text-left table-auto text-sm font-poppins",children:[(0,P.jsx)("thead",{children:(0,P.jsxs)("tr",{className:"bg-gray-100",children:[s.includes("storeName")&&(0,P.jsxs)("th",{className:"px-2 py-2 cursor-pointer",onClick:function(){return r("storeName")},children:["Customer Name ","storeName"===n&&("asc"===a?"↑":"↓")]}),s.includes("employeeName")&&(0,P.jsxs)("th",{className:"px-2 py-2 cursor-pointer",onClick:function(){return r("employeeName")},children:["Executive ","employeeName"===n&&("asc"===a?"↑":"↓")]}),s.includes("visit_date")&&(0,P.jsxs)("th",{className:"px-2 py-2 cursor-pointer",onClick:function(){return r("visit_date")},children:["Date ","visit_date"===n&&("asc"===a?"↑":"↓")]}),s.includes("outcome")&&(0,P.jsx)("th",{className:"px-2 py-2",children:"Status"}),s.includes("purpose")&&(0,P.jsxs)("th",{className:"px-2 py-2 cursor-pointer",onClick:function(){return r("purpose")},children:["Purpose ","purpose"===n&&("asc"===a?"↑":"↓")]}),s.includes("visitStart")&&(0,P.jsx)("th",{className:"px-2 py-2",children:"Visit Start"}),s.includes("visitEnd")&&(0,P.jsx)("th",{className:"px-2 py-2",children:"Visit End"}),s.includes("intent")&&(0,P.jsxs)("th",{className:"px-2 py-2 cursor-pointer",onClick:function(){return r("intent")},children:["Intent ","intent"===n&&("asc"===a?"↑":"↓")]}),(0,P.jsx)("th",{className:"px-2 py-2",children:"Last Updated"}),(0,P.jsx)("th",{className:"px-2 py-2",children:"Actions"})]})}),(0,P.jsx)("tbody",{children:t.map(function(e){var t=h(e),n=t.icon,a=t.status,r=t.color;return(0,P.jsxs)("tr",{className:"border-b",children:[s.includes("storeName")&&(0,P.jsx)("td",{className:"px-2 py-2",children:e.storeName}),s.includes("employeeName")&&(0,P.jsx)("td",{className:"px-2 py-2",children:e.employeeName}),s.includes("visit_date")&&(0,P.jsx)("td",{className:"px-2 py-2 whitespace-nowrap",children:I(e.visit_date)}),s.includes("outcome")&&(0,P.jsx)("td",{className:"px-2 py-2",children:(0,P.jsxs)(N.C,{className:"".concat(r," px-3 py-1 rounded-full font-semibold"),children:[n," ",a]})}),s.includes("purpose")&&(0,P.jsx)("td",{className:"px-2 py-2 relative",children:(0,P.jsxs)("div",{className:"group cursor-pointer",children:[e.purpose?e.purpose.length>20?"".concat(e.purpose.slice(0,20),"..."):e.purpose:"-",e.purpose&&e.purpose.length>20&&(0,P.jsx)("div",{className:"absolute left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg hidden group-hover:block z-10 w-80",children:(0,P.jsx)("p",{className:"text-sm text-gray-800",children:e.purpose})})]})}),s.includes("visitStart")&&(0,P.jsxs)("td",{className:"px-2 py-2 whitespace-nowrap",children:[(0,P.jsx)("div",{children:I(e.checkinDate)}),(0,P.jsx)("div",{children:Z(e.checkinDate,e.checkinTime)})]}),s.includes("visitEnd")&&(0,P.jsxs)("td",{className:"px-2 py-2 whitespace-nowrap",children:[(0,P.jsx)("div",{children:I(e.checkoutDate)}),(0,P.jsx)("div",{children:Z(e.checkoutDate,e.checkoutTime)})]}),s.includes("intent")&&(0,P.jsx)("td",{className:"px-2 py-2",children:e.intent}),(0,P.jsxs)("td",{className:"px-2 py-2 whitespace-nowrap",children:[(0,P.jsx)("div",{children:I(e.updatedAt)}),(0,P.jsx)("div",{children:Z(e.updatedAt,e.updatedTime)})]}),(0,P.jsx)("td",{className:"px-2 py-2",children:(0,P.jsx)(f.z,{variant:"outline",className:"text-gray-500 hover:text-gray-700 transition-colors duration-200",onClick:function(){return p(e.id.toString())},children:"View Details"})})]},e.id)})})]})}),(0,P.jsx)("div",{className:"md:hidden space-y-4",children:t.map(function(e,t){var n=h(e),a=n.icon,r=n.status,i=n.color,c=u===e.id;return(0,P.jsxs)(M.E.div,{className:"bg-white shadow-lg rounded-lg overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},children:[(0,P.jsxs)(M.E.div,{className:"p-4 cursor-pointer",onClick:function(){return m(c?null:e.id)},whileHover:{backgroundColor:"#f3f4f6"},transition:{duration:.2},children:[(0,P.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,P.jsxs)(N.C,{className:"".concat(i," px-3 py-1 rounded-full font-semibold flex items-center space-x-1"),children:[a," ",(0,P.jsx)("span",{children:r})]}),(0,P.jsx)("span",{className:"text-sm text-gray-500",children:I(e.visit_date)})]}),(0,P.jsxs)("div",{className:"flex items-center justify-between",children:[(0,P.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,P.jsx)(k.Z,{className:"w-5 h-5 text-blue-500"}),(0,P.jsx)("span",{className:"font-semibold text-lg",children:e.storeName})]}),(0,P.jsx)(M.E.div,{animate:{rotate:c?180:0},transition:{duration:.3},children:(0,P.jsx)(w.Z,{className:"w-5 h-5 text-gray-500"})})]})]}),(0,P.jsx)(A.M,{children:c&&(0,P.jsxs)(M.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"px-4 pb-4 space-y-3",children:[s.includes("employeeName")&&(0,P.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,P.jsx)(C.Z,{className:"w-4 h-4 text-indigo-500"}),(0,P.jsx)("span",{className:"font-semibold",children:"Executive:"})," ",e.employeeName]}),s.includes("purpose")&&(0,P.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,P.jsx)(D.Z,{className:"w-4 h-4 text-green-500"}),(0,P.jsx)("span",{className:"font-semibold",children:"Purpose:"})," ",e.purpose||"-"]}),s.includes("intent")&&(0,P.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,P.jsx)(S.Z,{className:"w-4 h-4 text-purple-500"}),(0,P.jsx)("span",{className:"font-semibold",children:"Intent:"})," ",e.intent]}),(0,P.jsx)(M.E.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,P.jsxs)(f.z,{variant:"outline",className:"w-full mt-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white hover:from-indigo-600 hover:to-purple-700 transition-all duration-300",onClick:function(){return p(e.id.toString())},children:[(0,P.jsx)("span",{children:"View Details"}),(0,P.jsx)(E.Z,{className:"w-4 h-4 ml-2"})]})})]})})]},e.id)})})]})},F=s(82422),z=s(18190),T=s(35843),R=s(39498),U=s(59447),V=s(33526),O=s(85051),L=s(25141),W=s(12954),B=s(43944),G=s(18664),Q=s(71229),J=s(82359),H=function(e,t){var s=(0,d.useState)(e),n=s[0],a=s[1];return(0,d.useEffect)(function(){var s=setTimeout(function(){a(e)},t);return function(){clearTimeout(s)}},[e,t]),n},X=function(e){var t=e.onFilter,s=e.onColumnSelect,n=e.onExport,a=e.selectedColumns,r=e.viewMode,i=e.startDate,c=e.setStartDate,o=e.endDate,l=e.setEndDate,u=e.purpose,m=(e.setPurpose,e.storeName),h=(e.setStoreName,e.employeeName);e.setEmployeeName;var x=(0,p.v9)(function(e){return e.auth.role}),N=(0,d.useState)(!1),j=N[0],y=N[1],g=(0,d.useState)(!1),k=g[0],w=g[1],C=(0,d.useState)(m),D=C[0],S=C[1],E=(0,d.useState)(h),M=E[0],A=E[1],I=(0,d.useState)(u),Z=I[0],_=I[1],X=H(D,300),$=H(M,300),q=H(Z,300);(0,d.useEffect)(function(){t({storeName:X,employeeName:$,purpose:q},!1)},[X,$,q,t]);var Y=function(e,t){switch(e){case"storeName":S(t);break;case"employeeName":A(t);break;case"purpose":_(t)}},K=function(e){Y(e,"")},ee={"Customer Name":"storeName",Executive:"employeeName",visit_date:"visit_date",Status:"outcome",purpose:"purpose",visitStart:"visitStart",visitEnd:"visitEnd",intent:"intent"},et=function(e){s(ee[e])},es=function(e){var t=e.placeholder,s=e.value,n=e.onChange,a=e.onClear;return e.field,(0,P.jsxs)("div",{className:"relative w-full",children:[(0,P.jsx)(z.I,{type:"text",placeholder:t,value:s,onChange:function(e){return n(e.target.value)},className:"w-full pr-8 pl-10"}),(0,P.jsx)(W.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),s&&(0,P.jsx)("button",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",onClick:a,children:(0,P.jsx)(B.Z,{size:16})})]})},en=function(e){var t=e.label,s=e.date,n=e.setDate;return(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsx)(L._,{htmlFor:t,className:"mb-1 block text-sm font-medium text-gray-700",children:t}),(0,P.jsxs)(U.J2,{children:[(0,P.jsx)(U.xo,{asChild:!0,children:(0,P.jsxs)(f.z,{id:t,variant:"outline",className:(0,J.cn)("w-full justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[(0,P.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),s?(0,v.WU)(s,"PPP"):(0,P.jsx)("span",{children:"Pick a date"})]})}),(0,P.jsx)(U.yk,{className:"w-auto p-0",align:"start",children:(0,P.jsx)(R.f,{mode:"single",selected:s,onSelect:n,initialFocus:!0})})]})]})},ea=function(){return(0,P.jsxs)("div",{className:"space-y-4",children:[(0,P.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,P.jsx)(es,{placeholder:"Customer Name",value:D,onChange:function(e){return Y("storeName",e)},onClear:function(){return K("storeName")},field:"storeName"}),(0,P.jsx)(es,{placeholder:"Sales Executive Name",value:M,onChange:function(e){return Y("employeeName",e)},onClear:function(){return K("employeeName")},field:"employeeName"}),(0,P.jsx)(es,{placeholder:"Purpose",value:Z,onChange:function(e){return Y("purpose",e)},onClear:function(){return K("purpose")},field:"purpose"})]}),(0,P.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,P.jsx)(en,{label:"Start Date",date:i,setDate:c}),(0,P.jsx)(en,{label:"End Date",date:o,setDate:l})]})]})},er=function(){return(0,P.jsxs)("div",{className:"flex flex-wrap gap-2 justify-end mt-4",children:[(0,P.jsxs)(V.Vq,{open:j,onOpenChange:y,children:[(0,P.jsx)(V.hg,{asChild:!0,children:(0,P.jsx)(f.z,{variant:"default",children:"Create Visit"})}),(0,P.jsx)(V.cZ,{className:"sm:max-w-[425px]",children:(0,P.jsx)(Q.default,{closeModal:function(){return y(!1)}})})]}),"table"===r&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(T.h_,{children:[(0,P.jsx)(T.$F,{asChild:!0,children:(0,P.jsx)(f.z,{variant:"outline",children:"Columns"})}),(0,P.jsx)(T.AW,{children:Object.keys(ee).map(function(e){return(0,P.jsx)(T.bO,{checked:a.includes(ee[e]),onCheckedChange:function(){return et(e)},children:e},e)})})]}),"ADMIN"===x&&(0,P.jsx)(f.z,{onClick:n,children:"Export"})]})]})};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:"md:hidden",children:(0,P.jsxs)(O.yo,{open:k,onOpenChange:w,children:[(0,P.jsx)(O.aM,{asChild:!0,children:(0,P.jsxs)(f.z,{variant:"outline",className:"w-full mb-4",children:[(0,P.jsx)(G.Z,{className:"mr-2 h-4 w-4"})," Filter Visits"]})}),(0,P.jsxs)(O.ue,{side:"right",children:[(0,P.jsx)(O.Tu,{children:(0,P.jsx)(O.bC,{children:"Visits Filter"})}),(0,P.jsxs)("div",{className:"py-4 space-y-6",children:[(0,P.jsx)(ea,{}),(0,P.jsx)(er,{})]}),(0,P.jsx)(O.FF,{children:(0,P.jsx)(f.z,{onClick:function(){return w(!1)},className:"w-full",children:"Apply Filters"})})]})]})}),(0,P.jsx)("div",{className:"hidden md:block",children:(0,P.jsx)(F.Zb,{className:"bg-white shadow-sm",children:(0,P.jsxs)(F.aY,{className:"p-6",children:[(0,P.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Visits Filter"}),(0,P.jsxs)("div",{className:"space-y-6",children:[(0,P.jsx)(ea,{}),(0,P.jsx)(er,{})]})]})})})]})},$=s(56846),q=s(94495),Y=s(5411);s(5438);var K=new h.QueryClient,ee=(n=(0,o.Z)(u().mark(function e(t,s,n,a,r,i,c,o,l,d){var p,h,x,f,N;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p=s?(0,v.WU)(s,"yyyy-MM-dd"):"",h=n?(0,v.WU)(n,"yyyy-MM-dd"):"",x="https://api.gajkesaristeels.in/visit/getByDateSorted?startDate=".concat(p,"&endDate=").concat(h,"&page=").concat(l-1,"&size=").concat(d),c&&(x+="&sort=".concat(c,",").concat(o)),a&&(x+="&purpose=".concat(encodeURIComponent(a))),r&&(x+="&storeName=".concat(encodeURIComponent(r))),i&&(x+="&employeeName=".concat(encodeURIComponent(i))),f={},t&&(f.Authorization="Bearer ".concat(t)),e.next=11,m.Z.get(x,{headers:f});case 11:return N=e.sent,e.abrupt("return",N.data);case 13:case"end":return e.stop()}},e)})),function(e,t,s,a,r,i,c,o,l,u){return n.apply(this,arguments)}),et=(a=(0,o.Z)(u().mark(function e(t,s,n,a,r,i,c,o,l,d){var p,h,x,f,N;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p=n?(0,v.WU)(n,"yyyy-MM-dd"):"",h=a?(0,v.WU)(a,"yyyy-MM-dd"):"",x="https://api.gajkesaristeels.in/visit/getForTeam?teamId=".concat(s,"&startDate=").concat(p,"&endDate=").concat(h,"&page=").concat(l-1,"&size=").concat(d),c&&(x+="&sort=".concat(c,",").concat(o)),r&&(x+="&purpose=".concat(encodeURIComponent(r))),i&&(x+="&storeName=".concat(encodeURIComponent(i))),f={},t&&(f.Authorization="Bearer ".concat(t)),e.next=10,m.Z.get(x,{headers:f});case 10:return N=e.sent,e.abrupt("return",N.data);case 12:case"end":return e.stop()}},e)})),function(e,t,s,n,r,i,c,o,l,u){return a.apply(this,arguments)}),es=(r=(0,o.Z)(u().mark(function e(t,s,n,a,r,i){var o,l,d,m;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=0,l=100,d=[];case 3:return e.next=6,et(t,s,n,a,"","",r,i,o+1,l);case 6:if(m=e.sent,d.push.apply(d,(0,c.Z)(m.content)),!m.last){e.next=10;break}return e.abrupt("break",13);case 10:o++,e.next=3;break;case 13:return e.abrupt("return",d);case 14:case"end":return e.stop()}},e)})),function(e,t,s,n,a,i){return r.apply(this,arguments)}),en=function(){var e=(0,x.useRouter)(),t=(0,p.v9)(function(e){return e.auth.token}),s=(0,p.v9)(function(e){return e.auth.role}),n=(0,p.v9)(function(e){return e.auth.teamId}),a=history.state||{},r=a.date,l=a.employeeName,f=(0,h.useQueryClient)(),N=(0,d.useState)("table"),j=N[0];N[1];var y=(0,d.useState)(r?new Date(r):(0,$.k)(new Date,7)),g=y[0],b=y[1],k=(0,d.useState)(r?new Date(r):new Date),w=k[0],C=k[1],D=(0,d.useState)("id"),S=D[0],E=D[1],M=(0,d.useState)("desc"),A=M[0],I=M[1],Z=(0,d.useState)(1),F=Z[0],z=Z[1],T=(0,d.useState)(""),R=T[0],U=T[1],V=(0,d.useState)(""),O=V[0],L=V[1],W=(0,d.useState)(l||""),B=W[0],G=W[1],Q=(0,d.useState)([]),J=Q[0],H=Q[1],K=(0,d.useState)(["storeName","employeeName","visit_date","purpose","outcome","visitStart","visitEnd","intent","city","state","storePrimaryContact","district","subDistrict"]),en=K[0],ea=K[1],er=(0,d.useCallback)(function(){localStorage.setItem("visitsListState",JSON.stringify({startDate:g,endDate:w,sortColumn:S,sortDirection:A,currentPage:F,purpose:R,storeName:O,employeeName:B}))},[g,w,S,A,F,R,O,B]);(0,d.useEffect)(function(){var e=localStorage.getItem("selectedDate"),s=localStorage.getItem("employeeName");if(e&&(b(new Date(e)),C(new Date(e))),s&&G(s.trim().replace(/\s+/g," ")),e&&s){var n=encodeURIComponent(s),a="https://api.gajkesaristeels.in/visit/getByDateSorted?startDate=".concat(e,"&endDate=").concat(e,"&page=0&size=10&sort=id,desc&employeeName=").concat(n),r={};t&&(r.Authorization="Bearer ".concat(t)),m.Z.get(a,{headers:r}).then(function(e){H(e.data.content)}).catch(function(e){console.error("Error fetching data:",e)})}},[t]),(0,d.useEffect)(function(){var e=function(){localStorage.removeItem("selectedDate"),localStorage.removeItem("employeeName")};return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}},[]),(0,d.useEffect)(function(){var t=function(e){"/VisitsList"!==e&&(localStorage.removeItem("selectedDate"),localStorage.removeItem("employeeName"))};return e.events.on("routeChangeStart",t),function(){e.events.off("routeChangeStart",t)}},[e.events]);var ei=(0,d.useCallback)(function(){var e=localStorage.getItem("visitsListState");if(e){var t=JSON.parse(e);b(new Date(t.startDate)),C(new Date(t.endDate)),E(t.sortColumn),I(t.sortDirection),z(t.currentPage),U(t.purpose),L(t.storeName),G(t.employeeName)}},[]);(0,d.useEffect)(function(){localStorage.getItem("selectedDate")?ei():(b((0,$.k)(new Date,7)),C(new Date))},[ei]),(0,d.useEffect)(function(){er()},[er]);var ec=(0,h.useQuery)(["visits",t,s,n,g,w,R,O,B,S,A,F,10],function(){return"MANAGER"===s&&n?et(t,n,g,w,R,O,S,A,F,10):"ADMIN"===s||"OFFICE MANAGER"===s?ee(t,g,w,R,O,B,S,A,F,10):void 0},{enabled:!!t&&("MANAGER"===s?!!n:"ADMIN"===s||"OFFICE MANAGER"===s),keepPreviousData:!0}),eo=ec.data,el=ec.error,eu=ec.isLoading,ed=(null==eo?void 0:eo.content)||[],em=eo?eo.totalPages:1,ep=(0,d.useCallback)(function(e){S===e?I(function(e){return"asc"===e?"desc":"asc"}):(E(e),I("asc"))},[S]),eh=(0,d.useCallback)(function(e,t){t?(L(""),G(""),U("")):(L(e.storeName),G(e.employeeName),U(e.purpose)),z(1),f.invalidateQueries(["visits"])},[f]),ex=(0,d.useCallback)(function(e){z(e)},[]),ef=(0,d.useCallback)(function(e){var t=en.filter(function(e){return"outcome"!==e}).map(function(e){switch(e){case"storeName":return"Customer Name";case"employeeName":return"Executive";case"visit_date":return"Date";case"purpose":return"Purpose";case"visitStart":return"Visit Start";case"visitEnd":return"Visit End";case"intent":return"Intent";case"storePrimaryContact":return"Phone Number";case"district":return"District";case"subDistrict":return"Sub District";default:return e}}),s=e.map(function(e){var t={};return en.filter(function(e){return"outcome"!==e}).forEach(function(s){switch(s){case"visitStart":t[s]=ev(e.checkinDate,e.checkinTime);break;case"visitEnd":t[s]=ev(e.checkoutDate,e.checkoutTime);break;case"storePrimaryContact":t[s]=e.storePrimaryContact;break;case"district":t[s]=e.district;break;case"subDistrict":t[s]=e.subDistrict;break;default:t[s]=e[s]}}),Object.values(t)});(0,q.Pz)(s,{header:!0,columns:t},function(e,t){if(e){console.error("Error converting data to CSV:",e);return}var s=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(s),n.download="visits.csv",n.click()})},[en]),eN=(0,d.useCallback)(function(e){ea(function(t){return t.includes(e)?t.filter(function(t){return t!==e}):[].concat((0,c.Z)(t),[e])})},[]),ev=(0,d.useCallback)(function(e,t){if(e&&t){var s=t.split(":"),n=(0,i.Z)(s,2),a=n[0],r=n[1];return(0,v.WU)(new Date("".concat(e,"T").concat(a,":").concat(r)),"dd MMM h:mm a")}return""},[]),ej=(0,d.useCallback)((0,o.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("MANAGER"===s&&!n)){e.next=2;break}return e.abrupt("return");case 2:if("MANAGER"!==s){e.next=9;break}return e.next=5,es(t,n,g,w,S,A);case 5:ef(e.sent),e.next=14;break;case 9:if(!("ADMIN"===s||"OFFICE MANAGER"===s)){e.next=14;break}return e.next=12,ee(t,g,w,R,O,B,S,A,1,1e3);case 12:ef(e.sent.content);case 14:case"end":return e.stop()}},e)})),[s,n,t,g,w,R,O,B,S,A,ef]);return eu?(0,P.jsx)("div",{children:"Loading..."}):el?(0,P.jsxs)("div",{children:["Error fetching visits: ",el.message]}):(0,P.jsxs)("div",{className:"container-visit mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(0,P.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Visits List"}),(0,P.jsx)(X,{onFilter:eh,onColumnSelect:eN,onExport:ej,selectedColumns:en,viewMode:j,startDate:g,setStartDate:b,endDate:w,setEndDate:C,purpose:R,setPurpose:U,storeName:O,setStoreName:L,employeeName:B,setEmployeeName:G}),(0,P.jsx)("div",{className:"w-full overflow-x-auto",children:(0,P.jsx)(_,{visits:ed.length>0?ed:J,selectedColumns:en,sortColumn:S,sortDirection:A,itemsPerPage:10,currentPage:F,onSort:ep,onBulkAction:function(){}})}),(0,P.jsx)("div",{className:"mt-8 flex justify-center",children:function(){var e=[],t=Math.max(F-Math.floor(2.5),1),s=t+5-1;s>em&&(t=Math.max((s=em)-5+1,1));for(var n=t;n<=s;n++)e.push(n);return(0,P.jsx)(Y.tl,{children:(0,P.jsxs)(Y.ng,{children:[1!==F&&(0,P.jsx)(Y.dN,{onClick:function(){return ex(F-1)}}),t>1&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Y.nt,{children:(0,P.jsx)(Y.kN,{onClick:function(){return ex(1)},children:"1"})}),t>2&&(0,P.jsx)(Y.nt,{children:(0,P.jsx)(Y.kN,{children:"..."})})]}),e.map(function(e){return(0,P.jsx)(Y.nt,{children:(0,P.jsx)(Y.kN,{isActive:e===F,onClick:function(){return ex(e)},children:e})},e)}),s<em&&(0,P.jsxs)(P.Fragment,{children:[s<em-1&&(0,P.jsx)(Y.nt,{children:(0,P.jsx)(Y.kN,{children:"..."})}),(0,P.jsx)(Y.nt,{children:(0,P.jsx)(Y.kN,{onClick:function(){return ex(em)},children:em})})]}),F!==em&&(0,P.jsx)(Y.$0,{onClick:function(){return ex(F+1)}})]})})}()})]})},ea=function(){return(0,P.jsx)(h.QueryClientProvider,{client:K,children:(0,P.jsx)(en,{})})}},98461:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/VisitsList",function(){return s(8601)}])},5438:function(){}},function(e){e.O(0,[9545,6066,2116,4145,8482,7152,8776,5277,6438,1229,2888,9774,179],function(){return e(e.s=98461)}),_N_E=e.O()}]);